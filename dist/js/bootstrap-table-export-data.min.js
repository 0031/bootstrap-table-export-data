!function(t){"use strict";var o=t.fn.bootstrapTable.utils.sprintf,e={csv:".csv",excel:".excel",sql:".sql",xml:".xml",json:".json"},n={showExport:!1,exportTypes:["excel","csv","sql","json","xml"],exportOptions:{minPageSize:100,maxPageSize:1e3,pageSizeStep:50,customPageSize:300}},s=!1,a="";t.extend(t.fn.bootstrapTable.defaults,n),t.extend(t.fn.bootstrapTable.defaults.icons,{export:"fa fa-file-o"}),t.extend(t.fn.bootstrapTable.locales,{formatExport:function(){return"导出到文件"}}),t.extend(t.fn.bootstrapTable.defaults,t.fn.bootstrapTable.locales);var i=t.fn.bootstrapTable.Constructor,p=i.prototype.initToolbar;i.prototype.initToolbar=function(){if(this.showToolbar=this.options.showExport,p.apply(this,Array.prototype.slice.apply(arguments)),this.options.showExport){var n=this,i=this.$toolbar.find(">.btn-group"),r=i.find("div.export-data");if(!r.length){var l="",c="";""!=a&&(c=" open",l=" export-loading"),r=t(['<div class="export-data btn-group',c,l,'">','<button class="btn'+o(" btn-%s",this.options.buttonsClass)+o(" btn-%s",this.options.iconSize)+' dropdown-toggle"title="'+this.options.formatExport()+'">',o('<i class="%s %s"></i> ',this.options.iconsPrefix,this.options.icons.export),'<span class="caret"></span>',"</button>",'<ul class="dropdown-menu" role="menu">',"</ul>","</div>"].join("")).appendTo(i);var u=r.find(".dropdown-menu"),f=this.options.exportTypes;if("string"==typeof this.options.exportTypes){var d=this.options.exportTypes.slice(1,-1).replace(/ /g,"").split(",");f=[],t.each(d,function(t,o){f.push(o.slice(1,-1))})}var b="",h="";if(s?b="checked":h='style="display: none"',u.append(['<li data-stop-propagation="true">','<div class="custom-export" title="开启此功能, 每页显示条数将切换为自定义值">',"<span>自定义条数</span>&nbsp;&nbsp;",'<input class="switchery custom-export-switch" type="checkbox"',b,">","</div>","</li>",'<li class="change-custom-page-size" ',h,">",'<div class="touch-spin-box">','<div class="form-group">','<input class="touch-spin custom-page-size" type="text">',"</div>","</li>"].join("")),"function"==typeof Switchery?new Switchery(document.querySelector(".export-data .switchery"),{size:"small"}):console.error("未引入abpetkov/switchery.js, 请检查代码."),"function"==typeof t.fn.TouchSpin){var x=t("input.custom-page-size");x.TouchSpin({min:t.fn.bootstrapTable.defaults.exportOptions.minPageSize,max:t.fn.bootstrapTable.defaults.exportOptions.maxPageSize,step:t.fn.bootstrapTable.defaults.exportOptions.pageSizeStep,initval:t.fn.bootstrapTable.defaults.exportOptions.customPageSize,buttondown_class:"btn btn-info",buttonup_class:"btn btn-info"}),x.on("change",function(){t.fn.bootstrapTable.defaults.exportOptions.customPageSize=parseInt(t(this).val())}),x.on("touchspin.on.min",function(){"function"==typeof swal?swal("抱歉","不能再小啦.","warning"):(console.log("未引入t4t5/sweetalert.js, 输出到控制台."),console.warn("不能再小啦."))}),x.on("touchspin.on.max",function(){"function"==typeof swal?swal("抱歉","为减小服务器压力, 每页最多只能导出"+t.fn.bootstrapTable.defaults.exportOptions.maxPageSize+"条数据.","warning"):(console.log("未引入t4t5/sweetalert.js, 输出到控制台."),console.warn("不能再小啦"))}),t(".custom-page-size").on("keydown",function(o){13==o.keyCode&&t(this).blur(),o.stopPropagation()})}else console.error("未引入istvan-ujjmeszaros/bootstrap-touchspin.js, 请检查代码.");var g=function(o){a=o;var e=t("li[data-type="+o+"] > a");e.loading().btnLoading("正在生成"+e.html()+'文件&nbsp;<span class="loading dots"></span>')},m=function(o){a="",t("li[data-type="+o+"] > a").loading().btnLoaded(1e3,"生成完毕, 请保存.")};t.each(f,function(t,o){var n=['<a href="javascript:;">',e[o],"</a>"].join("");e.hasOwnProperty(o)&&(u.append(['<li data-type="'+o+'">',n,"</li>"].join("")),""!=a&&o==a&&g(o))}),t(".btn-group > .dropdown-toggle").off("click").on("click",function(o){var e=t(this).parent(),n=e.hasClass("open");t(".btn-group").each(function(){t(this).removeClass("open")}),n?e.removeClass("open"):e.addClass("open"),o.stopPropagation()}),u.find("li > a").on("click",function(){var o=t(this).parent().data("type");g(o),r.hasClass("export-loading")||r.addClass("export-loading");var e=function(){r.hasClass("export-loading")&&(r.removeClass("export-loading"),"function"==typeof n.$el.tableExport?(n.$el.tableExport(t.extend({},n.options.exportOptions,{type:o,escape:!1})),m(o)):console.error("hhurz/tableExport.jquery.plugin.js未引入, 请检查代码."))};s?(x.trigger("change"),"function"==typeof window.customExportTable?window.customExportTable(function(){e()}):console.warn("window.customExportTable函数不存在, 自定义导出开关未生效.")):e()}),u.find(".custom-export > span").eq(0).on("click",function(){t(".custom-export-switch").trigger("click")}),u.find(".custom-export-switch").on("change",function(){s=t(this).get(0).checked;var o=t(".change-custom-page-size");s?(o.slideDown(),x.trigger("change")):o.slideUp()})}}}}(jQuery);