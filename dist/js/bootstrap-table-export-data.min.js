!function(t){"use strict";var o=t.fn.bootstrapTable.utils.sprintf,e={csv:".csv",excel:".excel",sql:".sql",xml:".xml",json:".json"},n={showExport:!1,exportTypes:["excel","csv","sql","json","xml"],exportOptions:{minPageSize:100,maxPageSize:1e3,pageSizeStep:50,customPageSize:300,customExportTableCallback:function(){}}},s=!1,a="";t.extend(t.fn.bootstrapTable.defaults,n),t.extend(t.fn.bootstrapTable.defaults.icons,{export:"fa fa-file-o"}),t.extend(t.fn.bootstrapTable.locales,{formatExport:function(){return"导出到文件"}}),t.extend(t.fn.bootstrapTable.defaults,t.fn.bootstrapTable.locales);var i=t.fn.bootstrapTable.Constructor,p=i.prototype.initToolbar;i.prototype.initToolbar=function(){if(p.apply(this,Array.prototype.slice.apply(arguments)),this.options.showExport){var n=this,i=this.$toolbar.find(">.btn-group"),r=i.find("div.export-data");if(!r.length){var l="",c="";""!=a&&(c=" open",l=" export-loading"),r=t(['<div class="export-data btn-group',c,l,'">','<button class="btn'+o(" btn-%s",this.options.buttonsClass)+o(" btn-%s",this.options.iconSize)+' dropdown-toggle"title="'+this.options.formatExport()+'" data-toggle="dropdown">',o('<i class="%s %s"></i> ',this.options.iconsPrefix,this.options.icons.export),'<span class="caret"></span>',"</button>",'<ul class="dropdown-menu" role="menu" data-stop-propagation="true">',"</ul>","</div>"].join("")).appendTo(i);var u=r.find(".dropdown-menu"),d=this.options.exportTypes;if("string"==typeof this.options.exportTypes){var f=this.options.exportTypes.slice(1,-1).replace(/ /g,"").split(",");d=[],t.each(f,function(t,o){d.push(o.slice(1,-1))})}var b="",x="";if(s?b="checked":x='style="display: none"',u.append(['<li data-stop-propagation="true">','<div class="custom-export" title="开启此功能, 每页显示条数将切换为自定义值">',"<span>自定义条数</span>&nbsp;&nbsp;",'<input class="switchery custom-export-switch" type="checkbox"',b,">","</div>","</li>",'<li class="change-custom-page-size" ',x,">",'<div class="touch-spin-box">','<div class="form-group">','<input class="touch-spin custom-page-size" type="text">',"</div>","</li>"].join("")),"function"==typeof Switchery?new Switchery(document.querySelector(".export-data .switchery"),{size:"small"}):console.error("未引入abpetkov/switchery.js, 请检查代码."),"function"==typeof t.fn.TouchSpin){var g=t("input.custom-page-size");g.TouchSpin({min:t.fn.bootstrapTable.defaults.exportOptions.minPageSize,max:t.fn.bootstrapTable.defaults.exportOptions.maxPageSize,step:t.fn.bootstrapTable.defaults.exportOptions.pageSizeStep,initval:t.fn.bootstrapTable.defaults.exportOptions.customPageSize,buttondown_class:"btn btn-info",buttonup_class:"btn btn-info"}),g.on("change",function(){t.fn.bootstrapTable.defaults.exportOptions.customPageSize=parseInt(t(this).val())}),g.on("touchspin.on.min",function(){"function"==typeof swal?swal("抱歉","不能再小啦.","warning"):(console.log("未引入t4t5/sweetalert.js, 输出到控制台."),console.warn("不能再小啦."))}),g.on("touchspin.on.max",function(){"function"==typeof swal?swal("抱歉","为减小服务器压力, 每页最多只能导出"+t.fn.bootstrapTable.defaults.exportOptions.maxPageSize+"条数据.","warning"):(console.log("未引入t4t5/sweetalert.js, 输出到控制台."),console.warn("不能再小啦"))}),t(".custom-page-size").on("keydown",function(o){13==o.keyCode&&t(this).blur(),o.stopImmediatePropagation()})}else console.error("未引入istvan-ujjmeszaros/bootstrap-touchspin.js, 请检查代码.");var h=function(o){a=o;var e=t("li[data-type="+o+"] > a");e.loading().btnLoading("正在生成"+e.html()+'文件&nbsp;<span class="loading dots"></span>')},m=function(o){a="",t("li[data-type="+o+"] > a").loading().btnLoaded(1e3,"生成完毕, 请保存.")};t.each(d,function(t,o){var n=['<a href="javascript:;">',e[o],"</a>"].join("");e.hasOwnProperty(o)&&(u.append(['<li data-type="'+o+'">',n,"</li>"].join("")),""!=a&&o==a&&h(o))}),u.find("li > a").on("click",function(){var o=t(this).parent().data("type");h(o),r.hasClass("export-loading")||r.addClass("export-loading");var e=function(){r.hasClass("export-loading")&&(r.removeClass("export-loading"),"function"==typeof n.$el.tableExport?(n.$el.tableExport(t.extend({},n.options.exportOptions,{type:o,escape:!1})),m(o)):console.error("hhurz/tableExport.jquery.plugin.js未引入, 请检查代码."))};s?(g.trigger("change"),"function"==typeof n.options.exportOptions.customExportTableCallback?n.options.exportOptions.customExportTableCallback(function(){e()}):console.warn("customExportTableCallback函数不存在, 自定义导出开关未生效.")):e()}),u.find(".custom-export > span").eq(0).on("click",function(){t(".custom-export-switch").trigger("click")}),u.find(".custom-export-switch").on("change",function(){s=t(this).get(0).checked;var o=t(".change-custom-page-size");s?(o.slideDown(),g.trigger("change")):o.slideUp()}),t("body").on("click","[data-stop-propagation]",function(t){t.stopImmediatePropagation()})}}}}(jQuery);